/*
 * bootstrap-filestyle
 * doc: http://jcputney.github.io/bootstrap-filestyle/
 * github: https://github.com/jcputney/bootstrap-filestyle
 *
 * Copyright (c) 2017 Markus Vinicius da Silva Lima
 * Version 2.1.3
 * Licensed under the MIT license.
 */
!function(o){"use strict";function a(t,e){this.options=e,this.$elementFilestyle=[],this.$element=o(t)}var s=0;a.prototype={clear:function(){this.$element.val(""),this.$elementFilestyle.find(":text").val(""),this.$elementFilestyle.find(".badge").remove()},destroy:function(){this.$element.removeAttr("style").removeData("filestyle"),this.$elementFilestyle.remove()},disabled:function(t){if(!0!==t&&!1!==t)return this.options.disabled;this.options.disabled=t,this.$element.prop("disabled",this.options.disabled),this.$elementFilestyle.find(".filestyle-button").prop("disabled",this.options.disabled),this.options.disabled?this.$elementFilestyle.find(".filestyle-button").css("opacity","0.65"):this.$elementFilestyle.find(".filestyle-button").css("opacity","1")},dragdrop:function(t){if(!0!==t&&!1!==t)return this.options.dragdrop;this.options.dragdrop=t},useLabel:function(t){if(!0!==t&&!1!==t)return this.options.useLabel;this.options.useLabel=t},buttonBefore:function(t){if(!0===t)this.options.buttonBefore||(this.options.buttonBefore=t,this.options.input&&(this.$elementFilestyle.remove(),this.constructor(),this.pushNameFiles()));else{if(!1!==t)return this.options.buttonBefore;this.options.buttonBefore&&(this.options.buttonBefore=t,this.options.input&&(this.$elementFilestyle.remove(),this.constructor(),this.pushNameFiles()))}},input:function(t){if(!0===t)this.options.input||(this.options.input=t,this.options.buttonBefore?this.$elementFilestyle.append(this.htmlInput()):this.$elementFilestyle.prepend(this.htmlInput()),this.pushNameFiles(),this.$elementFilestyle.find(".group-span-filestyle").addClass("input-group-btn"));else{if(!1!==t)return this.options.input;this.options.input&&(this.options.input=t,this.$elementFilestyle.find(":text").remove(),this.$elementFilestyle.find(".group-span-filestyle").removeClass("input-group-btn"))}},size:function(t){if(void 0===t)return this.options.size;this.options.size=t;var e=this.$elementFilestyle.find(".filestyle-button"),i=this.$elementFilestyle.find("input");e.removeClass("btn-lg btn-sm"),i.removeClass("form-control-lg form-control-sm"),"nr"!=this.options.size&&(e.addClass("btn-"+this.options.size),i.addClass("form-control-"+this.options.size))},placeholder:function(t){if(void 0===t)return this.options.placeholder;this.options.placeholder=t,this.$elementFilestyle.find("input").attr("placeholder",t)},text:function(t){if(void 0===t)return this.options.text;this.options.text=t,this.$elementFilestyle.find(".filestyle-button .text").html(this.options.text)},inputTitle:function(t){if(void 0===t)return this.options.inputTitle;this.options.inputTitle=t,this.$elementFilestyle.find("input").attr("title",t)},btnClass:function(t){if(void 0===t)return this.options.btnClass;this.options.btnClass=t,this.$elementFilestyle.find(".filestyle-button").attr({class:"btn "+this.options.btnClass+" btn-"+this.options.size})},badge:function(t){if(!0===t){this.options.badge=t;var e=this.pushNameFiles();this.$elementFilestyle.find(".filestyle-button").append(' <span class="badge '+this.options.badgeName+'">'+e.length+"</span>")}else{if(!1!==t)return this.options.badge;this.options.badge=t,this.$elementFilestyle.find(".badge").remove()}},badgeName:function(t){if(void 0===t)return this.options.badgeName;this.options.badgeName=t,this.$elementFilestyle.find(".badge").attr({class:"badge "+this.options.badgeName})},htmlIcon:function(t){return void 0!==t&&(this.options.htmlIcon=t),this.options.htmlIcon},htmlInput:function(){return this.options.input?'<input type="text" class="form-control '+("nr"==this.options.size?"":"form-control-"+this.options.size)+'" placeholder="'+this.options.placeholder+'" title="'+this.options.inputTitle+'" disabled> ':""},pushNameFiles:function(){var t="",e=[];void 0===this.$element[0].files?e[0]={name:this.$element[0]&&this.$element[0].value}:e=this.$element[0].files;for(var i=0;i<e.length;i++)t+=e[i].name.split("\\").pop()+", ";return""!==t?this.$elementFilestyle.find(":text").val(t.replace(/\, $/g,"")):this.$elementFilestyle.find(":text").val(""),e},constructor:function(){var t,e,i=this,n=i.$element.attr("id");""!==n&&n||(n="filestyle-"+s,i.$element.attr({id:n}),s++),e='<span class="group-span-filestyle '+(i.options.input?i.options.buttonBefore?"input-group-prepend":"input-group-append":"")+'">'+(i.options.useLabel?'<label for="'+n+'"':'<button type="button"')+' style="margin-bottom: 0;" class="filestyle-button btn '+i.options.btnClass+" "+("nr"==i.options.size?"":"btn-"+i.options.size)+'" '+(i.options.disabled||i.$element.attr("disabled")?' disabled="true"':"")+">"+i.htmlIcon()+'<span class="buttonText">'+i.options.text+"</span>"+(i.options.useLabel?"</label>":"</button>")+"</span>",t=i.options.buttonBefore?e+'<div name="filedrag"></div>'+i.htmlInput():i.htmlInput()+'<div name="filedrag"></div>'+e,i.$elementFilestyle=o('<div class="bootstrap-filestyle input-group">'+t+"</div>"),i.$elementFilestyle.find(".group-span-filestyle").attr("tabindex","0").keypress(function(t){if(13===t.keyCode||32===t.charCode)return i.$elementFilestyle.find(".filestyle-button").click(),!1}),i.$element.css({position:"absolute",clip:"rect(0px 0px 0px 0px)"}).attr("tabindex","-1").after(i.$elementFilestyle),i.$elementFilestyle.find(i.options.buttonBefore?".filestyle-button":":input").css({"border-top-left-radius":".25rem","border-bottom-left-radius":".25rem"}),i.$elementFilestyle.find('[name="filedrag"]').css({position:"absolute",width:"100%",height:i.$elementFilestyle.height()+"px","z-index":-1}),(i.options.disabled||i.$element.attr("disabled"))&&(i.$element.attr("disabled","true"),i.options.disabled?i.$elementFilestyle.find(".filestyle-button").css("opacity","0.65"):i.$elementFilestyle.find(".filestyle-button").css("opacity","1")),i.$element.change(function(){var t=i.pushNameFiles();i.options.badge?0==i.$elementFilestyle.find(".badge").length?i.$elementFilestyle.find(".filestyle-button").append(' <span class="badge '+i.options.badgeName+'">'+t.length+"</span>"):0==t.length?i.$elementFilestyle.find(".badge").remove():i.$elementFilestyle.find(".badge").html(t.length):i.$elementFilestyle.find(".badge").remove(),i.options.onChange(t)}),i.$elementFilestyle.find(".filestyle-button").click(function(){return i.$element.click(),!1}),o(document).on("dragover",function(t){t.preventDefault(),t.stopPropagation(),i.options.dragdrop&&o('[name="filedrag"]').css("z-index","9")}).on("drop",function(t){t.preventDefault(),t.stopPropagation(),i.options.dragdrop&&o('[name="filedrag"]').css("z-index","-1")}),i.$elementFilestyle.find('[name="filedrag"]').on("dragover",function(t){t.preventDefault(),t.stopPropagation()}).on("dragenter",function(t){t.preventDefault(),t.stopPropagation()}).on("drop",function(t){if(t.originalEvent.dataTransfer&&!i.options.disabled&&i.options.dragdrop&&t.originalEvent.dataTransfer.files.length){t.preventDefault(),t.stopPropagation(),i.$element[0].files=t.originalEvent.dataTransfer.files;var e=i.pushNameFiles();i.options.badge?0==i.$elementFilestyle.find(".badge").length?i.$elementFilestyle.find(".filestyle-button").append(' <span class="badge '+i.options.badgeName+'">'+e.length+"</span>"):0==e.length?i.$elementFilestyle.find(".badge").remove():i.$elementFilestyle.find(".badge").html(e.length):i.$elementFilestyle.find(".badge").remove(),o('[name="filedrag"]').css("z-index","-1")}})}};var t=o.fn.filestyle;o.fn.filestyle=function(n,s){var l="";this.each(function(){if("file"===o(this).attr("type")){var t=o(this),e=t.data("filestyle"),i=o.extend({},o.fn.filestyle.defaults,n,"object"==typeof n&&n);e||(t.data("filestyle",e=new a(this,i)),e.constructor()),"string"==typeof n&&(l=e[n](s))}});return l},o.fn.filestyle.defaults={text:"Choose file",htmlIcon:"",btnClass:"btn-secondary",size:"nr",input:!0,badge:!1,badgeName:"badge-light",buttonBefore:!1,dragdrop:!0,useLabel:!0,disabled:!1,placeholder:"",inputTitle:"",onChange:function(){}},o.fn.filestyle.noConflict=function(){return o.fn.filestyle=t,this},o(function(){o(".filestyle").each(function(){var t=o(this),e={input:"false"!==t.attr("data-input"),htmlIcon:t.attr("data-icon"),buttonBefore:"true"===t.attr("data-buttonBefore"),disabled:"true"===t.attr("data-disabled"),size:t.attr("data-size"),text:t.attr("data-text"),btnClass:t.attr("data-btnClass"),badge:"true"===t.attr("data-badge"),dragdrop:"false"!==t.attr("data-dragdrop"),useLabel:"false"!==t.attr("data-useLabel"),badgeName:t.attr("data-badgeName"),placeholder:t.attr("data-placeholder"),inputTitle:t.attr("data-inputTitle")};t.filestyle(e)})})}(window.jQuery);